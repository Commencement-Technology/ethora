import{k as a,aa as X,bE as Y,l as t,av as H,a3 as i,X as S,an as C,W as g,aM as K,bF as _,bG as x,Y as q,bH as z,a9 as J}from"./index-451a7b86.js";import{L as Q,T as Z,C as tt,X as et,Y as st,b as at}from"./LineChart-7981a9d2.js";import"./index-da19c86c.js";function u(n){const{children:o,value:c,index:l,...y}=n;return t.jsx("div",{role:"tabpanel",hidden:c!==l,id:`simple-tabpanel-${l}`,"aria-labelledby":`simple-tab-${l}`,style:{height:"100%"},...y,children:c===l&&t.jsx(i,{sx:{p:3},children:t.jsx(S,{children:o})})})}function p(n){return{id:`simple-tab-${n}`,"aria-controls":`simple-tabpanel-${n}`,disableFocusRipple:!0}}const h=({data:n,name:o})=>t.jsxs(Q,{height:500,width:900,data:n,margin:{top:5,right:30,left:20,bottom:5},children:[t.jsx(Z,{}),t.jsx(tt,{strokeDasharray:"3 3"}),t.jsx(et,{dataKey:"name"}),t.jsx(st,{label:{value:o,angle:-90,position:"left"}}),t.jsx(at,{type:"monotone",dataKey:"value",stroke:"#8884d8",activeDot:{r:8}})]});function ct(){const[n,o]=a.useState(0),[c,l]=a.useState(0),[y,v]=a.useState(0),[D,I]=a.useState(0),[T,w]=a.useState(0),[b,nt]=a.useState(!1),[A,G]=a.useState([]),[L,$]=a.useState([]),[k,P]=a.useState([]),[U,M]=a.useState([]),{appId:B}=X(),[f,E]=a.useState(()=>{const e=new Date;return e.setDate(1),e.setHours(0,0,0,0),e.toISOString()}),[m,N]=a.useState(()=>new Date().toISOString()),R=new URL(Y.API_URL).origin,j=async()=>{try{const{data:s}=await z(B,f,m);I(s.transactionsCount),l(s.apiCallCount),w(s.issuanceCount),v(s.sessionsCount),G(e(s.sessions)),P(e(s.transactions)),M(e(s.issuance)),$(e(s.apiCalls))}catch{}function e(s){const d=[];for(const[r,W]of s.y.entries())d.push({value:W,name:g(new Date(s.x[r]),"yyyy-MM-dd")});return d}};a.useEffect(()=>{j()},[]);const F=(e,s)=>{o(s)},O=async()=>{await j()},V=async()=>{const s="data:text/csv,"+(await J()({url:`${R}/analysis/apis-csv?startDate=${f}&endDate=${m}`})).data,d="api.csv",r=document.createElement("a");r.href=s,r.download=d,r.click()};return t.jsxs(H,{maxWidth:"xl",style:{height:"calc(100vh - 68px)",paddingTop:"20px"},children:[t.jsx(i,{style:{paddingBottom:"20px"},children:t.jsx(S,{variant:"h4",children:"Statistics"})}),t.jsxs(i,{style:{display:"flex",marginBottom:"20px"},children:[t.jsx(C,{id:"date",label:"From",type:"date",defaultValue:g(new Date(f),"yyyy-MM-dd"),sx:{width:220},InputLabelProps:{shrink:!0},onChange:e=>{console.log(e.target.value),E(new Date(e.target.value).toISOString())},style:{paddingRight:"15px"}}),t.jsx(C,{id:"date",label:"To",type:"date",defaultValue:g(new Date(m),"yyyy-MM-dd"),sx:{width:220},InputLabelProps:{shrink:!0},onChange:e=>N(new Date(e.target.value).toISOString()),style:{paddingRight:"15px"}}),t.jsx(K,{loading:b,variant:"outlined",disabled:b,onClick:O,children:"Filter Stats"})]}),t.jsxs(i,{sx:{width:"100%",height:"100%"},className:"tabs-start",children:[t.jsx(i,{children:t.jsxs(_,{value:n,onChange:F,"aria-label":"basic tabs example",variant:"fullWidth",centered:!1,children:[t.jsx(x,{label:`Sessions - ${y}`,...p(0),style:{textAlign:"left",textTransform:"none",alignItems:"flex-start"}}),t.jsx(x,{label:`API calls - ${c}`,...p(1),className:"statistic-tab",style:{textAlign:"left",textTransform:"none",alignItems:"flex-start"}}),t.jsx(x,{label:`Issuence - ${T}`,...p(2),style:{textAlign:"left",textTransform:"none",alignItems:"flex-start"}}),t.jsx(x,{label:`Blockchain Transactions - ${D}`,...p(3),style:{textAlign:"left",textTransform:"none",alignItems:"flex-start"}})]})}),t.jsx(u,{value:n,index:0,children:t.jsx(i,{className:"tabpanel-box",style:{display:"flex",justifyContent:"center"},children:t.jsx(h,{data:A,name:"Sessions"})})}),t.jsxs(u,{value:n,index:1,children:[t.jsx(i,{className:"tabpanel-box",style:{display:"flex",justifyContent:"center"},children:t.jsx(h,{data:L,name:"APIs"})}),t.jsx(q,{onClick:V,children:"Upload CSV"})]}),t.jsx(u,{value:n,index:2,children:t.jsx(i,{className:"tabpanel-box",style:{display:"flex",justifyContent:"center"},children:t.jsx(h,{data:U,name:"Issuance"})})}),t.jsx(u,{value:n,index:3,children:t.jsx(i,{className:"tabpanel-box",style:{display:"flex",justifyContent:"center"},children:t.jsx(h,{data:k,name:"Transaction"})})})]})]})}export{ct as default};
