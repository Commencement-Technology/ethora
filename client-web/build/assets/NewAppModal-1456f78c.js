import{R as B,a5 as l,k as g,ai as R,aI as D,l as e,al as F,a3 as d,S as T,ab as U,aG as G,an as I,aM as P,ca as E}from"./index-451a7b86.js";function O({open:S,setOpen:i}){const c=B.useRef(null),A=l(a=>a.setApp),b=l(a=>a.setUser),j=l(a=>a.user),[p,u]=g.useState(!1),[L,N]=g.useState(""),{showSnackbar:w}=R(),t=D({initialValues:{appName:"",appDescription:"",appGoogleId:"",defaultAccessProfileOpen:!0,defaultAccessAssetsOpen:!0,usersCanFree:!0,newUserTokenGift:0,coinsDayliBonus:0,appUrl:""},validate:a=>{const r={};return a.appName||(r.appName="Required"),r},onSubmit:({appName:a,appDescription:r,appGoogleId:f,defaultAccessAssetsOpen:k,defaultAccessProfileOpen:v,usersCanFree:y,appUrl:h})=>{u(!0);const s=new FormData;let o;if(c.current){const n=c.current.files;n&&(o=n[0])}o&&s.append("file",o),s.append("displayName",a),r&&s.append("appDescription",r.toString()),f&&s.append("appGoogleId",f.toString()),s.append("defaultAccessAssetsOpen",k.toString()),s.append("defaultAccessProfileOpen",v.toString()),s.append("usersCanFree",y.toString()),h&&s.append("appUrl",h.toString()),E(s).then(n=>{A(n.data.app),i(!1),b({...j,homeScreen:""})}).catch(n=>{var m,x;w("error","Cannot create the app "+(((x=(m=n.response)==null?void 0:m.data)==null?void 0:x.error)||""))}).finally(()=>u(!1))}}),C=()=>{i(!1),N("")};return e.jsx(F,{onClose:C,open:S,children:e.jsxs(d,{sx:{padding:1},children:[e.jsx(T,{sx:{position:"absolute",top:0,right:0},disabled:p,onClick:()=>i(!1),children:e.jsx(U,{})}),e.jsx(G,{sx:{padding:1},children:"New App"}),e.jsx(d,{sx:{width:"100%",padding:1},children:e.jsxs("form",{onSubmit:t.handleSubmit,style:{width:"300px"},children:[e.jsx(d,{children:e.jsx(I,{fullWidth:!0,error:!!t.touched.appName&&!!t.errors.appName,margin:"dense",label:"App Name",name:"appName",variant:"outlined",onChange:t.handleChange,onBlur:t.handleBlur,value:t.values.appName})}),e.jsx(P,{loading:p,variant:"contained",style:{marginTop:"15px",width:"100%"},type:"submit",disabled:p,children:"Create App"})]})})]})})}export{O as default};
